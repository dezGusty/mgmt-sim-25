<div *ngIf="request" class="max-w-2xl mx-auto bg-white rounded-lg shadow p-6">
  <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
    <svg
      class="w-5 h-5"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 512 512"
    >
      <path
        fill="oklch(54.6% 0.245 262.881)"
        d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9L0 168c0 13.3 10.7 24 24 24l110.1 0c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24l0 104c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65 0-94.1c0-13.3-10.7-24-24-24z"
      />
    </svg>
    Leave Request Details
  </h2>

  <div class="space-y-6">
    <div class="flex justify-between items-center">
      <div class="flex items-center gap-2">
        <span class="text-lg font-semibold text-gray-900">{{
          request.employeeName
        }}</span>
      </div>
      <span
        class="inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium border"
        [ngClass]="{
          'bg-yellow-100 text-yellow-800 border-yellow-200':
            request.status === 'Pending',
          'bg-green-100 text-green-800 border-green-200':
            request.status === 'Approved',
          'bg-red-100 text-red-800 border-red-200':
            request.status === 'Rejected'
        }"
      >
        <ng-container *ngIf="request.status === 'Pending'">
          <svg
            class="w-4 h-4"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 384 512"
          >
            <path
              fill="oklch(79.5% 0.184 86.047)"
              d="M32 0C14.3 0 0 14.3 0 32S14.3 64 32 64l0 11c0 42.4 16.9 83.1 46.9 113.1L146.7 256 78.9 323.9C48.9 353.9 32 394.6 32 437l0 11c-17.7 0-32 14.3-32 32s14.3 32 32 32l32 0 256 0 32 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l0-11c0-42.4-16.9-83.1-46.9-113.1L237.3 256l67.9-67.9c30-30 46.9-70.7 46.9-113.1l0-11c17.7 0 32-14.3 32-32s-14.3-32-32-32L320 0 64 0 32 0zM96 75l0-11 192 0 0 11c0 19-5.6 37.4-16 53L112 128c-10.3-15.6-16-34-16-53zm16 309c3.5-5.3 7.6-10.3 12.1-14.9L192 301.3l67.9 67.9c4.6 4.6 8.6 9.6 12.1 14.9L112 384z"
            />
          </svg>
        </ng-container>
        <ng-container *ngIf="request.status === 'Approved'">
          <svg
            class="w-4 h-4"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 512 512"
          >
            <path
              fill="oklch(62.7% 0.194 149.214)"
              d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"
            />
          </svg>
        </ng-container>
        <ng-container *ngIf="request.status === 'Rejected'">
          <svg
            class="w-4 h-4"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 512 512"
          >
            <path
              fill="oklch(57.7% 0.245 27.325)"
              d="M367.2 412.5L99.5 144.8C77.1 176.1 64 214.5 64 256c0 106 86 192 192 192c41.5 0 79.9-13.1 111.2-35.5zm45.3-45.3C434.9 335.9 448 297.5 448 256c0-106-86-192-192-192c-41.5 0-79.9 13.1-111.2 35.5L412.5 367.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z"
            />
          </svg>
        </ng-container>
        {{ request.status }}
      </span>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label
          class="text-sm font-medium text-gray-700 flex items-center gap-1 mb-2"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <circle cx="12" cy="12" r="10"></circle>
          </svg>
          Start Date
        </label>
        <p class="text-gray-900 bg-gray-50 px-3 py-2 rounded-md">
          {{ request.from }}
        </p>
      </div>
      <div>
        <label
          class="text-sm font-medium text-gray-700 flex items-center gap-1 mb-2"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <circle cx="12" cy="12" r="10"></circle>
          </svg>
          End Date
        </label>
        <p class="text-gray-900 bg-gray-50 px-3 py-2 rounded-md">
          {{ request.to }}
        </p>
      </div>

      <div>
        <label
          class="text-sm font-medium text-gray-700 flex items-center gap-1 mb-2"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            viewBox="0 0 24 24"
          >
            <circle cx="12" cy="12" r="10"></circle>
          </svg>
          Submitted On
        </label>
        <p class="text-gray-900 bg-gray-50 px-3 py-2 rounded-md">
          {{ request.createdAt }}
        </p>
      </div>
    </div>

    <div>
      <label
        class="text-sm font-medium text-gray-700 flex items-center gap-1 mb-2"
      >
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <circle cx="12" cy="12" r="10"></circle>
        </svg>
        Leave Type
      </label>
      <div class="bg-gray-50 px-3 py-2 rounded-md">
        <div *ngIf="request.leaveType" class="flex justify-between items-start">
          <h4 class="font-semibold text-gray-900">
            {{ request.leaveType.title }}
          </h4>
          <span
            class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium"
            [ngClass]="{
              'bg-green-100 text-green-800': request.leaveType.isPaid,
              'bg-gray-100 text-gray-800': !request.leaveType.isPaid
            }"
          >
            {{ request.leaveType.isPaid ? "Paid" : "Unpaid" }}
          </span>
        </div>
      </div>
    </div>

    <div>
      <label
        class="text-sm font-medium text-gray-700 flex items-center gap-1 mb-2"
      >
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <circle cx="12" cy="12" r="10"></circle>
        </svg>
        Reason for Leave
      </label>
      <div class="bg-gray-50 px-4 py-3 rounded-md">
        <p class="text-gray-900 whitespace-pre-wrap">
          {{ request.reason }}
        </p>
      </div>
    </div>

    <div
      *ngIf="
        (request.status === 'Approved' || request.status === 'Rejected') &&
        request.comment
      "
    >
      <label class="text-sm font-medium text-blue-700 mb-2 block">
        Comment
      </label>
      <div class="bg-blue-50 border border-blue-200 px-4 py-3 rounded-md">
        <p class="text-blue-800">{{ request.comment }}</p>
      </div>
    </div>

    <div *ngIf="request.status === 'Pending'" class="mb-4">
      <label class="text-sm font-medium text-gray-700 mb-2 block">
        Optional Comment
      </label>
      <textarea
        [(ngModel)]="pendingComment"
        [disabled]="!canModify"
        rows="2"
        [class]="canModify 
          ? 'w-full px-3 py-2 border rounded-md bg-gray-50 text-gray-900'
          : 'w-full px-3 py-2 border rounded-md bg-gray-100 text-gray-500 cursor-not-allowed'"
        [placeholder]="canModify ? 'Add a comment (optional)...' : 'Comentariile sunt dezactivate în modul view-only'"
      ></textarea>
    </div>

    <div
      class="flex flex-col sm:flex-row gap-3 pt-4 border-t"
      *ngIf="request.status === 'Pending'"
    >
      <button
        [disabled]="!canModify"
        [class]="canModify 
          ? 'flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded hover:cursor-pointer transition-all duration-200 transform hover:scale-105'
          : 'flex-1 bg-gray-400 text-gray-200 px-4 py-2 rounded cursor-not-allowed'"
        (click)="canModify && approve.emit({ id: request.id, comment: pendingComment })"
        [title]="!canModify ? 'Nu puteți aproba cereri în modul view-only' : ''"
      >
        Approve Request
      </button>
      <button
        [disabled]="!canModify"
        [class]="canModify 
          ? 'flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded hover:cursor-pointer transition-all duration-200 transform hover:scale-105'
          : 'flex-1 bg-gray-400 text-gray-200 px-4 py-2 rounded cursor-not-allowed'"
        (click)="canModify && reject.emit({ id: request.id, comment: pendingComment })"
        [title]="!canModify ? 'Nu puteți respinge cereri în modul view-only' : ''"
      >
        Reject Request
      </button>
    </div>

    <!-- View-only indicator -->
    <div *ngIf="!canModify && request.status === 'Pending'" class="mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-md">
      <div class="flex items-center">
        <svg class="w-5 h-5 text-yellow-400 mr-2" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
        </svg>
        <p class="text-sm text-yellow-700">
          <strong>Modul View-Only:</strong> Un manager secundar a preluat responsabilitățile dvs. temporar. Puteți vizualiza cererile dar nu le puteți aproba sau respinge.
        </p>
      </div>
    </div>
  </div>
</div>
